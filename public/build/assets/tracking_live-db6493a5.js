import{_ as u}from"./leaflet.rotatedMarker-71d1d069.js";import"./_commonjsHelpers-28e086c5.js";const f=window.sio;var r=$("input[name=_lat]").val(),a=$("input[name=_lon]").val(),l=$("input[name=_id]").val(),d=function(t){return L.icon({iconUrl:t,iconSize:window.c_marker_front_cfg[0],iconAnchor:window.c_marker_front_cfg[1]})},e=L.map("livemap",{minZoom:5,fullscreenControl:!0,attributionControl:!1}).setView([.33995192349439596,120.3733680354565],7),m=L.tileLayer(window.mapLayer);m.addTo(e);var n=new u([r,a],{draggable:!1,riseOnHover:!0,icon:d(window.c_marker_front)}).addTo(e),i=new L.FeatureGroup;i.addLayer(n);i.addTo(e);e.fitBounds(i.getBounds());var _=!0;setInterval(function(){_&&(n.setIcon(d(window.c_marker_front)),n.setRotationAngle(0))},15e3);f.on("trx_device_data_rcv",function(t){var o=JSON.parse(t);if(console.log(o,o.id,l),o.id===l){var c=new L.Polyline([{lat:r,lng:a},{lat:o.lat,lng:o.lon}],{color:"red",weight:5,opacity:.5,smoothFactor:1});c.addTo(e),console.log(c),r=o.lat,a=o.lon,n.slideTo([o.lat,o.lon],{duration:2e3,keepAtCenter:!1});var s=L.icon({iconUrl:window.c_marker_top,iconSize:window.c_marker_top_cfg[0]});n.setIcon(s),n.setRotationAngle(o.direction),n.setRotationOrigin("center center"),setTimeout(function(){_=!0},3e5)}});
