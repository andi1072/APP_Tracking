$("input[name=_id]").val();var c="https://tile.openstreetmap.org/{z}/{x}/{y}.png",p=L.tileLayer(c,{minZoom:5}),n=new L.Map("objmap",{center:new L.LatLng(.339951,120.373368),zoom:5,attributionControl:!1,fullscreenControl:!0});L.featureGroup().addTo(n);var d=0;L.Control.geocoder().addTo(n);L.control.layers({osm:p.addTo(n),google:L.tileLayer("http://www.google.cn/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}",{attribution:"google"})}).addTo(n);var t=null;n.on("click",function(e){var a=e.latlng.lat,l=e.latlng.lng;t&&n.removeLayer(t),t=window._newMarker({lat:a,lng:l},{icon:L.icon({iconUrl:window.gateUrl,iconSize:[30,30],iconAnchor:[8,25],popupAnchor:[0,-20]})}).addTo(n),console.log(t._latlng.lat)});$("#formGeo").submit(function(e){e.preventDefault();var a=$("input[name=sel_toll_section]").val(),l=$("input[name=txtgatename]").val();if(a)if(t){if(!l)return toastr.error("Gate Name REQUIRED!","Error"),null}else return toastr.error("Please click on map!","Error"),null;else return toastr.error("Toll Section REQUIRED!","Error"),null;var o=new FormData;o.append("_token",$("input[name=_token]").val()),o.append("txtsection",a),o.append("txtgatename",l),o.append("lat",t._latlng.lat),o.append("lon",t._latlng.lng),o.append("_isEdit",d),$.ajax({type:"POST",url:window.burl+"/gate/add/js",data:o,dataType:"json",contentType:!1,cache:!1,processData:!1,beforeSend:function(){$("#formGeo").css("opacity",".5")},success:function(r){$("#formGeo").css("opacity","");var s=r.msg;s.code===200?swal({title:"Success",text:"Continue add Declaration?",type:"success",showCancelButton:!0,confirmButtonClass:"btn-primary",confirmButtonText:"Yes!",cancelButtonText:"No, keep in here!",closeOnConfirm:!1,closeOnCancel:!1},function(i){i?window.location.href=window.burl+"/geomlff/add":window.location.reload()}):(console.log(r),toastr.error(r.msg,"Error"))}})});$("#sel_toll_section").select2();axios.get(window.burl+"/geomlff/gatepoint/section/js").then(e=>{$("#sel_toll_section").select2({data:e.data.sectionName})}).catch(e=>{console.log(e)});$("#sel_toll_section").on("change",function(){});
